
const image=document.querySelector("#cover"),title=document.getElementById("title"),artist=document.getElementById("artist"),music=document.querySelector("audio"),currentTimeEl=document.getElementById("current-time"),durationEl=document.getElementById("duration"),progress=document.getElementById("progress"),progressContainer=document.getElementById("progress-container"),prevBtn=document.getElementById("prev"),playBtn=document.getElementById("play"),nextBtn=document.getElementById("next"),background=document.getElementById("background"),shuffleBtn=document.getElementById("shuffle"),loopBtn=document.getElementById("loop"),volumeSlider=document.getElementById("volume"),songListContainer=document.getElementById("song-list");let isShuffle=!1,isLoop=!1,isPlaying=!1,songIndex=0;const songs=[{path:"media/billi(5).mp3",displayName:"Everything I Wanted",artist:"Billie Eilish",cover:"images/billi5.webp"},{path:"media/billi(2).mp3",displayName:"NDA",artist:"Billie Eilish",cover:"images/billi2.webp"},{path:"media/billi(1).mp3",displayName:"My Future",artist:"Billie Eilish",cover:"images/1.webp"},{path:"media/billi(3).mp3",displayName:"TV",artist:"Billie Eilish",cover:"images/billi3.webp"},{path:"media/billi(4).mp3",displayName:"Bury a Friend",artist:"Billie Eilish",cover:"images/billi4.webp"},{path:"media/billi(6).mp3",displayName:"Therefore I Am",artist:"Billie Eilish",cover:"images/billi6.webp"},{path:"media/dorcci.mp3",displayName:"Ghatle Amd",artist:"Dorcci",cover:"images/dorcci.webp"},{path:"media/dorcci2.mp3",displayName:"Before you Gone",artist:"Dorcci",cover:"images/dorcci2.webp"},{path:"media/massari.mp3",displayName:"Real Love",artist:"Massari",cover:"images/msri.webp"},{path:"media/pakzad.mp3",displayName:"Bombe",artist:"Sohrab Pakzad",cover:"images/pkzd.webp"},{path:"media/Poobon1.mp3",displayName:"12:34",artist:"Poobon",cover:"images/poobon.webp"},{path:"media/Poobon2.mp3",displayName:"Niloofar Abi",artist:"Poobon",cover:"images/poobon2.webp"},{path:"media/lady.mp3",displayName:"Die With A Smile",artist:"Lady Gaga",cover:"images/lady.webp"},{path:"media/beth.mp3",displayName:"Let Me Down Slowly",artist:"Beth",cover:"images/beth.webp"}];let audioCtx=null,gainNode=null;function initAudioContext(){if(!audioCtx){audioCtx=new(window.AudioContext||window.webkitAudioContext);let e=audioCtx.createMediaElementSource(music);(gainNode=audioCtx.createGain()).gain.value=volumeSlider.value,e.connect(gainNode).connect(audioCtx.destination)}}function loadSong(e){title.textContent=e.displayName,artist.textContent=e.artist,music.src=e.path,image.classList.remove("active"),setTimeout(()=>{image.src=e.cover,image.classList.add("active")},100),background.src=e.cover}function playSong(){isPlaying=!0,playBtn.classList.replace("fa-play","fa-pause"),music.play()}function pauseSong(){isPlaying=!1,playBtn.classList.replace("fa-pause","fa-play"),music.pause()}function nextSong(){if(isShuffle){let e;do e=Math.floor(Math.random()*songs.length);while(e===songIndex);songIndex=e}else songIndex=(songIndex+1)%songs.length;loadSong(songs[songIndex]),playSong(),updateActiveSong()}function prevSong(){loadSong(songs[songIndex=(songIndex-1+songs.length)%songs.length]),playSong(),updateActiveSong()}function updateProgressBar(e){if(!isPlaying)return;let{duration:t,currentTime:i}=e.srcElement;progress.style.width=`${i/t*100}%`,isNaN(t)||(durationEl.textContent=formatTime(t)),currentTimeEl.textContent=formatTime(i)}function formatTime(e){let t=Math.floor(e%60);return t<10&&(t=`0${t}`),`${Math.floor(e/60)}:${t}`}function getX(e){return e.touches?e.touches[0].clientX:e.clientX}function setProgress(e){let t=progressContainer.clientWidth,i=getX(e)-progressContainer.getBoundingClientRect().left,n=music.duration;n&&(music.currentTime=i/t*n)}function renderSongList(){songListContainer.innerHTML="",songs.forEach((e,t)=>{let i=document.createElement("li");i.innerHTML=`<span>${e.displayName} - ${e.artist}</span>`,t===songIndex&&i.classList.add("active-song"),i.onclick=()=>{loadSong(songs[songIndex=t]),playSong(),updateActiveSong()},songListContainer.appendChild(i)})}function updateActiveSong(){[...songListContainer.querySelectorAll("li")].forEach((e,t)=>{e.classList.toggle("active-song",t===songIndex)})}document.body.addEventListener("click",initAudioContext,{once:!0}),playBtn.onclick=()=>isPlaying?pauseSong():playSong(),prevBtn.onclick=prevSong,nextBtn.onclick=nextSong,music.addEventListener("timeupdate",updateProgressBar),progressContainer.addEventListener("click",setProgress),progressContainer.addEventListener("touchstart",setProgress),progressContainer.addEventListener("touchmove",setProgress),renderSongList(),shuffleBtn.onclick=()=>{isShuffle=!isShuffle,shuffleBtn.classList.toggle("active")},loopBtn.onclick=()=>{isLoop=!isLoop,loopBtn.classList.toggle("active")},music.addEventListener("ended",()=>{isLoop?playSong():nextSong()}),volumeSlider.value=.7,volumeSlider.oninput=e=>{gainNode&&(gainNode.gain.value=e.target.value)},loadSong(songs[songIndex]),window.onkeyup=e=>{"Space"===e.code&&playBtn.click(),"ArrowRight"===e.code&&nextSong(),"ArrowLeft"===e.code&&prevSong()},document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("loader"),t=document.getElementById("container");window.addEventListener("load",()=>{e.style.opacity="0",setTimeout(()=>{e.style.display="none",t.style.display="block"},300)})});